{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://hivemind.local/schemas/context-package.schema.json",
  "title": "Context Package",
  "description": "Schema for memory context packages used in agent handoffs",
  "type": "object",
  "required": ["package_id", "created_at", "source_agent", "memory_context"],
  "properties": {
    "package_id": {
      "type": "string",
      "pattern": "^ctx_[a-z0-9]{12}$",
      "description": "Unique context package identifier"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Package creation timestamp"
    },
    "source_agent": {
      "type": "string",
      "pattern": "^(DEV|SEC|INF|QA)-[0-9]{3}$|^COORDINATOR$",
      "description": "Agent that created this package"
    },
    "target_agent": {
      "type": ["string", "null"],
      "pattern": "^(DEV|SEC|INF|QA)-[0-9]{3}$|^COORDINATOR$",
      "description": "Intended recipient agent (null if broadcast)"
    },
    "task_context": {
      "type": "object",
      "properties": {
        "task_id": {"type": "string"},
        "task_summary": {"type": "string"},
        "task_status": {
          "type": "string",
          "enum": ["in_progress", "completed", "blocked", "handed_off"]
        },
        "work_completed": {"type": "string"},
        "work_remaining": {"type": "string"}
      },
      "description": "Context about the current task"
    },
    "memory_context": {
      "type": "object",
      "required": ["loaded_memories"],
      "properties": {
        "loaded_memories": {
          "type": "array",
          "items": {"type": "string"},
          "description": "IDs of memories that were loaded for this task"
        },
        "memories_created_this_task": {
          "type": "array",
          "items": {"type": "string"},
          "description": "IDs of memories created during this task"
        },
        "memories_updated_this_task": {
          "type": "array",
          "items": {"type": "string"},
          "description": "IDs of memories updated during this task"
        },
        "recommended_memories_for_next": {
          "type": "array",
          "items": {"type": "string"},
          "description": "IDs of memories recommended for the receiving agent"
        },
        "working_memory_snapshot": {
          "type": "object",
          "description": "Snapshot of current working memory state"
        }
      },
      "description": "Memory context for handoff"
    },
    "entities": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": {"type": "string"},
          "name": {"type": "string"},
          "context": {"type": "string"}
        }
      },
      "description": "Entities mentioned during the task"
    },
    "decisions_made": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "decision": {"type": "string"},
          "rationale": {"type": "string"},
          "memory_id": {"type": "string"}
        }
      },
      "description": "Decisions made during the task"
    },
    "pending_items": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Items requiring attention from receiving agent"
    },
    "notes": {
      "type": "string",
      "description": "Free-form notes for the receiving agent"
    }
  }
}
